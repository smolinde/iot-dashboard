# Project Story
‚Üê [Homepage](../)
## 1 Main Idea
As a car owner and someone who is often going somewhere, I permanently used to browse weather forecasts and gas prices on my phone. This is annoying, especially if you are in a rush and already too late. While studying at the University of Cologne and driving there almost every day, I always had to refill my gas tank. Also, oftentimes I forgot to check the weather and was dressed either too cold or too warm. At some point, we had a subject where we were intorduced into the world of IoT and had to work with microcontrollers. I have already gained expericence before as an owner of several Raspberry Pi's. However, I never focused much on cheaper microcontrollers such as Raspberry Pi Pico or ESP32. In November 2024, I discovered the Raspberry Pi Pico 2W from [this blog](https://www.raspberrypi.com/news/raspberry-pi-pico-2-w-on-sale-now/) and immediately ordered two of them, and short after created a [fuel price display](https://github.com/smolinde/iot-fuel-price-display). The project presented here is a continuation of that repository. After discovering the incredible variety of microelectronics on AliExpress, I ordered an ESP32-C3 along with an 3.5" TFT SPI dsiplay. From here, the project story of the dashboard begins.
## 2 Challenges
### 2.1 Hardware Design
To make a nice looking dashboard with no wires sticking out, I decided to simply glue the ESP32-C3 to the back of the display. I desoldered the GPIO pins and simply soldered everything together with regular wires. I also wanted to have a nice case with a transparent back. You can find more about the case on the [hardware setup](./hardware-setup.md) page. The initial version looked like this:

<p align="center">
<img src="../images/hardware_version_1.png" width=500></img><br>
First Version of Dashboard
</p>

Later, I realized that the small ceramic WLAN antenna is not really good, so I decided to overhaul and replace the ESP32-C3 with an advanced version with an IPEX antenna interface. The antenna itself is glued to the transparent back of the dashboard. Also, I improved the wiring by using thin copper bell wire which holds shape and just looks better than the mess before:

<p align="center">
<img src="../images/hardware_version_2.png" width=500></img><br>
Second Version of Dashboard
</p>

Now, this looks much better and also, the WLAN works fantastically. But then, another upgrade was necessary (more on this later in [2.4]()), and I had to replace the ESP32-C3 Plus with an ESP32-S3 Nano. The final version, as of today, looks like this:

<p align="center">
<img src="../images/hardware_version_3.png" width=500></img><br>
Final Version of Dashboard
</p>

As you can see, the design itself did not change at all, but the microcontroller and wiring did. The approach to use screws and nuts turned out to be a great choice because this way it was possible to do adjustments without breaking anything.

### 2.2 Software Architecture
The first challenge I had to solve is the software architecture design. For my idea, I had to combine numerous technologies into one single system. In the repository mentioned before, the project was quite simple and I simply wrote everything in [one single file](https://github.com/smolinde/iot-fuel-price-display/blob/master/main.py). While thinking of the various functions my display would have to fulfill, I decided it would be nice to have the functionality separated in its own classes and called in a central logic. This later turned out to be a good decision because the code resulting from this approach is non-repetetive and clean. So to say, each functionality has its onw file, e.g. [WeatherManager.py](../src/managers/WeatherManager.py) is only responsible for delivering weather data to the main program, as well as [DisplayManager.py](../src/managers/DisplayManager.py) is only responsible for the visualization of contents on the display.
### 2.3 ILI9488 Display Driver
Now, this was probably the most challenging part as <b>there is no single ILI9488 driver for MicroPython avaliable on the internet!</b> I had good hopes when I found [this repository](https://github.com/QiaoTuCodes/MicroPython-_ILI9488), but for me this simply did not work. Therefore, with no options left, I decided to write my own ILI9488 MicroPython driver. Generally speaking, drivers are translations from boring manuals provided from hardware manufacturers to plain code. With this in mind I decided to try and let [Manus AI](https://manus.im/app) develop the ILI9488 driver based on [this datasheet](https://www.hpinfotech.ro/ILI9488.pdf) and the previously mentioned repository. To my surprise, this worked really well! I had to tweak manually a little bit to adjust to the driver to the screen size, add screen rotation, and also include text rendering. This is probably the heart piece of the whole project as this driver is really new and can serve as a base for other enthusiasts who want to work with ILI9488-based displays. You can find the ILI9488 driver file [here](../src/drivers/ILI9488.py). Without this driver, the project would not be possible at all and I would have to choose either another display or switch the programming language to C++, which I honestly did not want to do.
### 2.4 Memory Issues
I was aware that the ESP32-C3 has very limited memory, thus I decided to put all icon files and fonts onto the external SD card as they are substantially larger than the code files. For file handling, there was a SDCardManager.py file, which also had hash verification for the SD card. I generated a file with hashes, stored it directly on the ESP32-C3, and before the main logic would run, the SD card manager class would verify all static files on the SD card to ensure no files were missing or changed. I was very happy with this solution and thought this would be a nice workaround for the small memory of the ESP32-C3. As the project grew, at some point of time, my dashboard started to crash at very random points in the program, with the scary error message `memory allocation failed`. At this point, I realized that I need a more powerful microcontroller with substantially more RAM than , so I found the ESP32-S3 Nano with IPEX antenna interface. This is exactly the thing I was looking for. With a whopping 512KB + 8000KB of total RAM (SRAM and PSRAM) instead of just only 400KB, I had now a microcontroller that could handle all of my files in the RAM alone. This made the hash verification obsolete and I simply removed this functionality and the corresponding methods in the SDCardManager.py, which I renamed to [FileManager.py](../src/managers/FileManager.py). From there, the SD card was only used for station icons and the configuration file, the only things that a user should touch. All of the other files (fonts, icons, error QR codes) were moved to the source code and are stored on the ESP32-S3 directly.
### 2.5 Updates
Where there is software, there are bugs. As a user, I would definetely like to have the dashboard supplied with the latest software updates. But usually you need to check manually for update releases, download a file, flash it to the device and just hope that you did not mess up anything. These thoughs wandered through my head while I was updating a brand-new [TP-Link ethernet switch](https://www.tp-link.com/de/business-networking/easy-smart-switch/tl-sg105e). It is not too complicated to do this, but I think for a regular user with no technical background this can be challenging. Therefore, with unused memory left, I decided to implement fully-automatic over-the-air (OTA) updates for the dashboard. GitHub provides an amazing API for fetching the latest repository release. Without any user interaction, the dashboard updates its own firmware at 3 am when the user is most likely sleeping. If the user does not want to have any automatic updates, the feature can be disabled in the configuration file. The OTA update procedure has no incredibly complicated logic and after having this implemented, I am really wondering why devices that are sold by big brands are still lacking this simple yet amazing feature. I think this is a must-have functionality, especially because almost all devices nowadays are connected to the internet anyway.
## 3 AI-Supported Development
Throughout the project, I used three AI tools - [ChatGPT](https://chatgpt.com/), [DeepSeek](https://chat.deepseek.com/), and [Manus AI](https://manus.im/app). Each of these tools has its own strengths and weaknesses, but in combination, they are basically omnipotent. Although they can write amazing texts and create good code, I wrote all of these texts manually and optimized code by hand. Never in my 25 years of life I would be able to create such a project (while finishing my master degree and then start working a full-time job) without the help of AI tools and large language models in this short amount of time. I think through AI I not only gained the missing pieces of code, but also a ton of specific knowledge related to this project. I had an amazing experience and want to encourage all developers to use AI for their projects, but always reflect critically on the artifacts created by AI. A software developer without AI is smart but slow, AI without a developer is fast but stupid. Combined together, they become a very powerful alloy. 
## 4 New Business Model
Just for the sake of fun, I decided to invent a new business model for this project and how it would generate renevue if implemented in real life. I think that the idea of corporate secrets in our modern world is heavily outdated and should be replaced by something new that aligns with nowadays common sense. More on that you can read on the [Business Model](./business-model.md) page.
## 5 Results
To summarize everything, I am quite happy with the output of this project. The dashboard hangs right next to my front door and I already got used to it. Every time I leave the house or come back home, this little device not only tells me the current time, weather, and gas prices, but also reminds me of the countless coding nights I have spent to create this little helper. I hope that one day, someone actually decides to build this thing and will use it like I do. And maybe even get an automatic firmware update, or request a station icon.

<p align="center"><a href="#project-story">Unscroll this page</a></p>